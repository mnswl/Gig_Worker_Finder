"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[14],{2253:()=>{},7014:(e,t,o)=>{o.r(t),o.d(t,{default:()=>c});var s=o(5043),a=o(3216),n=o(5475),l=o(4117),r=o(9442),i=o(9183),d=(o(2253),o(579));const c=function(){const e=(0,a.Zp)(),{t:t,i18n:o}=(0,l.Bd)(),c=e=>{o.changeLanguage(e),localStorage.setItem("lng",e)},[m,g]=(0,s.useState)({email:"",password:""}),[u,p]=(0,s.useState)("worker"),[h,x]=(0,s.useState)(!1),[b,j]=(0,s.useState)("");if(localStorage.getItem("token"))return(0,d.jsxs)("div",{className:"register-wrapper","data-aos":"fade-up",children:[(0,d.jsxs)("div",{className:"d-none",style:{top:10,right:10},children:[(0,d.jsx)("button",{className:"btn btn-light dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"\ud83c\udf10"}),(0,d.jsxs)("ul",{className:"dropdown-menu dropdown-menu-end",children:[(0,d.jsx)("li",{children:(0,d.jsx)("button",{className:"dropdown-item",onClick:()=>c("en"),children:"English"})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{className:"dropdown-item",onClick:()=>c("si"),children:"\u0dc3\u0dd2\u0d82\u0dc4\u0dbd"})})]})]}),(0,d.jsx)("img",{src:"/logo.png",alt:"Gig Worker Finder",className:"register-logo"}),(0,d.jsx)("div",{className:"alert alert-warning mt-4",children:t("alreadyLoggedIn")}),(0,d.jsx)(n.N_,{className:"btn btn-primary me-2 mt-3",to:"/dashboard",children:t("goToDashboard")}),(0,d.jsx)("button",{className:"btn btn-outline-danger mt-3",onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("role"),e("/login")},children:t("logout")})]});const v=e=>{g({...m,[e.target.name]:e.target.value})};return(0,d.jsxs)("div",{className:"register-wrapper","data-aos":"fade-up",children:[(0,d.jsxs)("div",{className:"d-none",style:{top:10,right:10},children:[(0,d.jsx)("button",{className:"btn btn-light dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"\ud83c\udf10"}),(0,d.jsxs)("ul",{className:"dropdown-menu dropdown-menu-end",children:[(0,d.jsx)("li",{children:(0,d.jsx)("button",{className:"dropdown-item",onClick:()=>c("en"),children:"English"})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{className:"dropdown-item",onClick:()=>c("si"),children:"\u0dc3\u0dd2\u0d82\u0dc4\u0dbd"})})]})]}),(0,d.jsx)("img",{src:"/logo.png",alt:"Gig Worker Finder",className:"register-logo"}),(0,d.jsx)("h2",{className:"h4 fw-bold mb-1",children:t("welcomeBack")}),(0,d.jsx)("p",{className:"text-muted mb-4",style:{fontSize:"0.9rem"},children:t("loginContinue")}),(0,d.jsxs)("div",{className:"mb-2 text-start",style:{maxWidth:"400px",margin:"0 auto"},children:[(0,d.jsx)("label",{className:"form-label",children:t("role")||"Role"}),(0,d.jsxs)("select",{className:"form-select",value:u,onChange:e=>p(e.target.value),children:[(0,d.jsx)("option",{value:"worker",children:t("worker")||"Freelancer"}),(0,d.jsx)("option",{value:"employer",children:t("employer")||"Client"})]})]}),(0,d.jsxs)("button",{className:"btn btn-outline-secondary w-100 d-flex align-items-center justify-content-center mb-3",onClick:()=>{(0,i.v)(async t=>{try{const o=await r.A.post("/auth/google",{idToken:t,role:u}),s=o.data.user;s.emailVerified||s.phoneVerified?(localStorage.setItem("token",o.data.token),localStorage.setItem("role",s.role),e("/dashboard")):(sessionStorage.setItem("token",o.data.token),sessionStorage.setItem("role",s.role),e("/verify",{state:{email:s.email,autoEmail:!0}}))}catch(a){var o,s;j((null===(o=a.response)||void 0===o||null===(s=o.data)||void 0===s?void 0:s.msg)||"Google sign-in failed")}})},children:[(0,d.jsx)("img",{src:"https://developers.google.com/identity/images/g-logo.png",alt:"Google",style:{height:18,width:18},className:"me-2"}),t("signInGoogle")]}),(0,d.jsx)("div",{className:"register-divider",children:t("or")}),b&&(0,d.jsx)("div",{className:"alert alert-danger",children:b}),(0,d.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await r.A.post("/auth/login",m),o=t.data.user;if(!(o.emailVerified||o.phoneVerified))return sessionStorage.setItem("token",t.data.token),sessionStorage.setItem("role",o.role),sessionStorage.setItem("userId",o.id),void e("/verify",{state:{email:o.email,phone:o.phone,autoEmail:!o.emailVerified&&!o.phoneVerified}});localStorage.setItem("token",t.data.token),localStorage.setItem("role",o.role),localStorage.setItem("userId",o.id),"admin"===o.role?e("/admin"):e("/dashboard")}catch(a){var o,s;j((null===(o=a.response)||void 0===o||null===(s=o.data)||void 0===s?void 0:s.msg)||"Login failed")}},children:[(0,d.jsxs)("div",{className:"mb-3 text-start",children:[(0,d.jsx)("label",{className:"form-label",children:t("emailOrPhone")}),(0,d.jsx)("input",{type:"text",name:"email",className:"form-control",value:m.email,onChange:v,required:!0})]}),(0,d.jsxs)("div",{className:"mb-3 text-start",children:[(0,d.jsx)("label",{className:"form-label",children:t("password")}),(0,d.jsxs)("div",{className:"input-group",children:[(0,d.jsx)("input",{type:h?"text":"password",name:"password",className:"form-control",value:m.password,onChange:v,required:!0}),(0,d.jsx)("button",{type:"button",className:"btn btn-outline-secondary",tabIndex:"-1",onClick:()=>x(e=>!e),children:h?"\ud83d\ude48":"\ud83d\udc41"})]})]}),(0,d.jsx)("button",{type:"submit",className:"btn btn-primary w-100",children:t("login")})]}),(0,d.jsxs)("p",{className:"mt-3",style:{fontSize:"0.9rem"},children:[t("noAccount")," ",(0,d.jsx)(n.N_,{to:"/register",children:t("register")})]})]})}},9183:(e,t,o)=>{o.d(t,{v:()=>s});const s=(e,t)=>{const o="1005694005465-e6up96sprkqb0n87qo8o8rsls7rnqa0t.apps.googleusercontent.com";const s=()=>{try{window.google.accounts.id.initialize({client_id:o,callback:t=>{let{credential:o}=t;return e(o)}}),window.google.accounts.id.prompt()}catch(s){console.error("Failed to initialize Google Accounts",s),t&&t(s)}};if(window.google&&window.google.accounts)return void s();const a=document.getElementById("gsi-script");if(a)return void a.addEventListener("load",s,{once:!0});const n=document.createElement("script");n.src="https://accounts.google.com/gsi/client",n.async=!0,n.defer=!0,n.id="gsi-script",n.onload=s,n.onerror=e=>{console.error("Failed to load Google Identity script",e),t&&t(e)},document.head.appendChild(n)}}}]);
//# sourceMappingURL=14.8282ba13.chunk.js.map