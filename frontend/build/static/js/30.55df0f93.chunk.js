"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[30],{3030:(e,a,t)=>{t.r(a),t.d(a,{default:()=>r});var n=t(5043),s=t(3216),o=t(9442),l=t(579);const r=function(){const e=(0,s.Zp)(),[a,t]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),[i,d]=(0,n.useState)(""),[h,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)("");(0,n.useEffect)(()=>{const e=e=>{"Enter"===e.key&&(r?r&&!h&&6===i.length&&f():a&&b())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a,r,i,h]);const b=async()=>{if(a)try{await o.A.patch("/auth/me",{phone:a}),await o.A.post("/auth/phone-code",{phone:a}),c(!0),p("Verification code sent via SMS")}catch(n){var e,t;console.error(n),p((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg)||"Failed to send phone code")}},f=async()=>{try{await o.A.post("/auth/verify-phone",{phone:a,code:i}),u(!0),p("Phone verified successfully"),e("/dashboard")}catch(s){var t,n;console.error(s),p((null===(t=s.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.msg)||"Verification failed")}};return(0,l.jsxs)("div",{className:"container py-5",style:{maxWidth:500},children:[(0,l.jsx)("h2",{className:"mb-3",children:"Set up Two-Factor Authentication"}),(0,l.jsx)("p",{className:"text-muted",children:"For additional security you can verify a phone number now. You may also skip and do this later."}),m&&(0,l.jsx)("div",{className:"alert alert-info",children:m}),(0,l.jsxs)("div",{className:"card card-body",children:[(0,l.jsx)("label",{className:"form-label",children:"Phone Number"}),(0,l.jsx)("input",{type:"text",className:"form-control mb-2",value:a,onChange:e=>t(e.target.value),placeholder:"e.g. +94771234567"}),r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{className:"form-label",children:"SMS Code"}),(0,l.jsx)("input",{type:"text",className:"form-control mb-2",value:i,onChange:e=>d(e.target.value),maxLength:6})]}),r?(0,l.jsx)("button",{className:"btn btn-success",onClick:f,disabled:6!==i.length,children:"Verify Phone"}):(0,l.jsx)("button",{className:"btn btn-primary",onClick:b,disabled:!a,children:"Send Code"})]}),(0,l.jsx)("button",{className:"btn btn-link mt-3",onClick:async()=>{try{a&&!h&&await o.A.patch("/auth/me",{phone:""})}catch(t){console.error(t)}finally{e("/dashboard")}},children:"Skip for now"})]})}}}]);
//# sourceMappingURL=30.55df0f93.chunk.js.map